From 70218525f318b4739609dd3d0a5d66825ffd42f8 Mon Sep 17 00:00:00 2001
From: bbcallen <bbcallen@gmail.com>
Date: Sun, 1 Apr 2012 13:59:45 +0800
Subject: [PATCH] build for tegra2

---
 Makefile                       |    7 ++++++-
 vlc-android/jni/Android.mk     |   15 +++++++++------
 vlc-android/jni/Application.mk |    2 ++
 3 files changed, 17 insertions(+), 7 deletions(-)

diff --git a/Makefile b/Makefile
index 03d6634..8b1fb16 100644
--- a/Makefile
+++ b/Makefile
@@ -1,7 +1,12 @@
 # Sources and objects
 
+LIBVLCJNI_MODULE_NAME = libvlcjni.so
+
 ifeq ($(NO_NEON),)
 ARCH = armeabi-v7a
+else ifneq ($(TEGRA2),)
+ARCH = armeabi-v7a
+LIBVLCJNI_MODULE_NAME = libvlcjni-tegra2.so
 else
 ARCH = armeabi
 endif
@@ -11,7 +16,7 @@ JAVA_SOURCES=$(SRC)/src/org/videolan/vlc/*.java
 JNI_SOURCES=$(SRC)/jni/*.c $(SRC)/jni/*.h
 VLC_APK=$(SRC)/bin/VLC-debug.apk
 LIBVLCJNI=	\
-	$(SRC)/obj/local/$(ARCH)/libvlcjni.so \
+	$(SRC)/obj/local/$(ARCH)/$(LIBVLCJNI_MODULE_NAME) \
 	$(SRC)/obj/local/$(ARCH)/libiomx-ics.so \
 	$(SRC)/obj/local/$(ARCH)/libiomx-gingerbread.so \
 
diff --git a/vlc-android/jni/Android.mk b/vlc-android/jni/Android.mk
index d203353..b8b91ae 100644
--- a/vlc-android/jni/Android.mk
+++ b/vlc-android/jni/Android.mk
@@ -1,18 +1,21 @@
 LOCAL_PATH := $(call my-dir)
 include $(CLEAR_VARS)
 
-LOCAL_MODULE    := libvlcjni
-
-LOCAL_SRC_FILES := libvlcjni.c aout.c pthread-condattr.c pthread-rwlocks.c
-
-LOCAL_C_INCLUDES := $(VLC_SRC_DIR)/include
-
 ifeq ($(NO_NEON),)
 ARCH=armeabi-v7a
+LOCAL_MODULE    := libvlcjni
+else ifneq ($(TEGRA2),)
+ARCH=armeabi-v7a
+LOCAL_MODULE    := libvlcjni-tegra2
 else
 ARCH=armeabi
+LOCAL_MODULE    := libvlcjni
 endif
 
+LOCAL_SRC_FILES := libvlcjni.c aout.c pthread-condattr.c pthread-rwlocks.c
+
+LOCAL_C_INCLUDES := $(VLC_SRC_DIR)/include
+
 ifeq ($(NO_NDK_V7),1)
 CPP_STATIC=$(ANDROID_NDK)/sources/cxx-stl/gnu-libstdc++/libs/$(ARCH)/libstdc++.a
 else
diff --git a/vlc-android/jni/Application.mk b/vlc-android/jni/Application.mk
index 9507cee..3e5f176 100644
--- a/vlc-android/jni/Application.mk
+++ b/vlc-android/jni/Application.mk
@@ -1,6 +1,8 @@
 APP_PLATFORM := android-9
 ifeq ($(NO_NEON),)
 APP_ABI := armeabi-v7a
+else ifneq ($(TEGRA2),)
+APP_ABI := armeabi-v7a
 else
 APP_ABI := armeabi
 endif
-- 
1.7.9.4

