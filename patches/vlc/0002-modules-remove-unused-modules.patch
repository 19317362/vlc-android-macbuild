From 112c42ee1734241d19e3dcb2ae983d0f63225f7a Mon Sep 17 00:00:00 2001
From: bbcallen <bbcallen@gmail.com>
Date: Tue, 22 Oct 2013 14:04:20 +0800
Subject: [PATCH 02/42] modules: remove unused modules

---
 configure.ac                      | 1 +
 modules/Makefile.am               | 1 -
 modules/access/Makefile.am        | 2 ++
 modules/codec/Makefile.am         | 2 ++
 modules/demux/Makefile.am         | 4 ++++
 modules/stream_filter/Makefile.am | 2 ++
 6 files changed, 11 insertions(+), 1 deletion(-)

diff --git a/configure.ac b/configure.ac
index 4794125..c0c7a03 100644
--- a/configure.ac
+++ b/configure.ac
@@ -333,6 +333,7 @@ AS_IF([test "$SYS" = linux],[
     ])
 ])
 AM_CONDITIONAL(HAVE_ANDROID, test "${HAVE_ANDROID}" = "1")
+AM_CONDITIONAL(MODULE_LITE, test "${HAVE_MODULE_FULL}" != "1")
 
 
 dnl
diff --git a/modules/Makefile.am b/modules/Makefile.am
index dc0fb39..14a8748 100644
--- a/modules/Makefile.am
+++ b/modules/Makefile.am
@@ -34,7 +34,6 @@ dist_noinst_DATA = MODULES_LIST
 
 include common.am
 include access/Makefile.am
-include access/rtp/Makefile.am
 include arm_neon/Makefile.am
 include audio_mixer/Makefile.am
 include audio_output/Makefile.am
diff --git a/modules/access/Makefile.am b/modules/access/Makefile.am
index a5b3679..aa4a781 100644
--- a/modules/access/Makefile.am
+++ b/modules/access/Makefile.am
@@ -150,6 +150,7 @@ if HAVE_QTKIT
 access_LTLIBRARIES += libqtcapture_plugin.la
 endif
 
+if !MODULE_LITE
 libv4l2_plugin_la_SOURCES = \
 	access/v4l2/linux/videodev2.h \
 	access/v4l2/linux/v4l2-common.h \
@@ -284,6 +285,7 @@ EXTRA_LTLIBRARIES += liblibbluray_plugin.la
 
 libaccess_bd_plugin_la_SOURCES = access/bd/bd.c access/bd/mpls.c access/bd/mpls.h access/bd/clpi.c access/bd/clpi.h
 access_LTLIBRARIES += libaccess_bd_plugin.la
+endif
 
 
 ### Digital TV ###
diff --git a/modules/codec/Makefile.am b/modules/codec/Makefile.am
index 14a53fd..5847597 100644
--- a/modules/codec/Makefile.am
+++ b/modules/codec/Makefile.am
@@ -147,9 +147,11 @@ codec_LTLIBRARIES += libdvbsub_plugin.la
 libscte27_plugin_la_SOURCES = codec/scte27.c
 codec_LTLIBRARIES += libscte27_plugin.la
 
+if !MODULE_LITE
 libspudec_plugin_la_SOURCES = codec/spudec/spudec.c codec/spudec/parse.c codec/spudec/spudec.h
 libspudec_plugin_la_CPPFLAGS = $(AM_CPPFLAGS)
 codec_LTLIBRARIES += libspudec_plugin.la
+endif
 
 libstl_plugin_la_SOURCES = codec/stl.c
 codec_LTLIBRARIES += libstl_plugin.la
diff --git a/modules/demux/Makefile.am b/modules/demux/Makefile.am
index 4ab22af..00e7419 100644
--- a/modules/demux/Makefile.am
+++ b/modules/demux/Makefile.am
@@ -120,11 +120,13 @@ libdemux_stl_plugin_la_SOURCES = demux/stl.c
 libdemux_stl_plugin_la_CPPFLAGS = $(AM_CPPFLAGS)
 demux_LTLIBRARIES += libdemux_stl_plugin.la
 
+if !MODULE_LITE
 libasf_plugin_la_SOURCES = demux/asf/asf.c demux/asf/libasf.c demux/asf/libasf.h demux/asf/libasf_guid.h
 demux_LTLIBRARIES += libasf_plugin.la
 
 libavi_plugin_la_SOURCES = demux/avi/avi.c demux/avi/libavi.c demux/avi/libavi.h
 demux_LTLIBRARIES += libavi_plugin.la
+endif
 
 libcaf_plugin_la_SOURCES = demux/caf.c
 libcaf_plugin_la_LIBADD = $(LIBM)
@@ -161,6 +163,7 @@ demux_LTLIBRARIES += libes_plugin.la
 libh264_plugin_la_SOURCES = demux/mpeg/h264.c
 demux_LTLIBRARIES += libh264_plugin.la
 
+if !MODULE_LITE
 libhevc_plugin_la_SOURCES = demux/mpeg/hevc.c demux/mpeg/mpeg_parser_helpers.h
 demux_LTLIBRARIES += libhevc_plugin.la
 
@@ -217,6 +220,7 @@ libplaylist_plugin_la_SOURCES = \
 	demux/playlist/zpl.c \
 	demux/playlist/playlist.c demux/playlist/playlist.h
 demux_LTLIBRARIES += libplaylist_plugin.la
+endif
 
 libts_plugin_la_SOURCES = demux/ts.c mux/mpeg/csa.c mux/mpeg/dvbpsi_compat.h demux/dvb-text.h
 libts_plugin_la_CFLAGS = $(AM_CFLAGS) $(DVBPSI_CFLAGS)
diff --git a/modules/stream_filter/Makefile.am b/modules/stream_filter/Makefile.am
index 158b46a..fc712b5 100644
--- a/modules/stream_filter/Makefile.am
+++ b/modules/stream_filter/Makefile.am
@@ -8,6 +8,7 @@ if !HAVE_WIN32
 stream_filter_LTLIBRARIES += libdecomp_plugin.la
 endif
 
+if !MODULE_LITE
 libdash_plugin_la_SOURCES = \
     stream_filter/dash/adaptationlogic/AbstractAdaptationLogic.cpp \
     stream_filter/dash/adaptationlogic/AbstractAdaptationLogic.h \
@@ -103,6 +104,7 @@ libsmooth_plugin_la_SOURCES = \
 
 libsmooth_plugin_la_CFLAGS = $(AM_CFLAGS)
 stream_filter_LTLIBRARIES += libsmooth_plugin.la
+endif
 
 libhttplive_plugin_la_SOURCES = stream_filter/httplive.c
 libhttplive_plugin_la_CFLAGS = $(AM_CFLAGS) $(GCRYPT_CFLAGS)
-- 
1.9.0

